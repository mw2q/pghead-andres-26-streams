BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%turquoise%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 260265016.841905
 ALGERIA                   |   1997 | 455602613.989573
 ALGERIA                   |   1996 |  452706876.40734
 ALGERIA                   |   1995 | 445502829.052332
 ALGERIA                   |   1994 | 452617027.626521
 ALGERIA                   |   1993 | 441759090.315815
 ALGERIA                   |   1992 | 447862141.326298
 ARGENTINA                 |   1998 | 266889450.527828
 ARGENTINA                 |   1997 | 459240005.120842
 ARGENTINA                 |   1996 | 468958497.950504
 ARGENTINA                 |   1995 |  473621214.85383
 ARGENTINA                 |   1994 | 467257748.556322
 ARGENTINA                 |   1993 | 460637680.216771
 ARGENTINA                 |   1992 | 464788895.208754
 BRAZIL                    |   1998 | 265927376.057944
 BRAZIL                    |   1997 | 463296368.826104
 BRAZIL                    |   1996 | 466089021.552152
 BRAZIL                    |   1995 | 460381364.327717
 BRAZIL                    |   1994 | 461535417.859311
 BRAZIL                    |   1993 | 455046576.083647
 BRAZIL                    |   1992 | 466349125.358475
 CANADA                    |   1998 | 278392106.567385
 CANADA                    |   1997 | 481328096.827293
 CANADA                    |   1996 | 485446136.246121
 CANADA                    |   1995 | 480432763.118924
 CANADA                    |   1994 |  483991526.90576
 CANADA                    |   1993 | 486479894.396589
 CANADA                    |   1992 | 488912163.905148
 CHINA                     |   1998 | 269140266.908301
 CHINA                     |   1997 |  444416877.04195
 CHINA                     |   1996 |  450250056.98243
 CHINA                     |   1995 | 448108860.577856
 CHINA                     |   1994 | 444853009.621403
 CHINA                     |   1993 | 454181071.823163
 CHINA                     |   1992 | 450819697.825913
 EGYPT                     |   1998 | 268471403.096726
 EGYPT                     |   1997 | 466318472.701701
 EGYPT                     |   1996 | 469351502.240605
 EGYPT                     |   1995 | 462413862.962936
 EGYPT                     |   1994 | 457479162.466468
 EGYPT                     |   1993 | 469582200.905239
 EGYPT                     |   1992 | 464033783.651352
 ETHIOPIA                  |   1998 | 263378468.058492
 ETHIOPIA                  |   1997 | 451889116.871282
 ETHIOPIA                  |   1996 | 455320732.174098
 ETHIOPIA                  |   1995 | 456938717.527354
 ETHIOPIA                  |   1994 | 453815356.657767
 ETHIOPIA                  |   1993 | 454813826.622594
 ETHIOPIA                  |   1992 | 460135683.945587
 FRANCE                    |   1998 | 267797312.212756
 FRANCE                    |   1997 | 459334054.381523
 FRANCE                    |   1996 |  464068934.45559
 FRANCE                    |   1995 | 459816324.218068
 FRANCE                    |   1994 | 456532695.971726
 FRANCE                    |   1993 | 461635390.553904
 FRANCE                    |   1992 | 456254701.352304
 GERMANY                   |   1998 | 276461230.209525
 GERMANY                   |   1997 | 474819841.514609
 GERMANY                   |   1996 | 478220520.256587
 GERMANY                   |   1995 | 476315996.112062
 GERMANY                   |   1994 | 473617708.470004
 GERMANY                   |   1993 | 471570584.330994
 GERMANY                   |   1992 | 469824036.108897
 INDIA                     |   1998 | 270337450.005049
 INDIA                     |   1997 | 471058714.053928
 INDIA                     |   1996 |  473603855.46635
 INDIA                     |   1995 | 467838955.762598
 INDIA                     |   1994 | 464586828.548764
 INDIA                     |   1993 | 463227634.633504
 INDIA                     |   1992 | 466061908.177013
 INDONESIA                 |   1998 | 270546494.455349
 INDONESIA                 |   1997 | 458010895.443718
 INDONESIA                 |   1996 | 462238780.702315
 INDONESIA                 |   1995 | 463706487.265353
 INDONESIA                 |   1994 | 460798921.893668
 INDONESIA                 |   1993 | 463238923.226932
 INDONESIA                 |   1992 | 464420283.310234
 IRAN                      |   1998 |  269704907.62427
 IRAN                      |   1997 | 459502352.540852
 IRAN                      |   1996 |  464638253.38881
 IRAN                      |   1995 | 461231999.190362
 IRAN                      |   1994 | 464054940.553743
 IRAN                      |   1993 | 466421532.851611
 IRAN                      |   1992 | 457697818.042671
 IRAQ                      |   1998 |  279523948.77248
 IRAQ                      |   1997 | 476213344.477509
 IRAQ                      |   1996 | 475558994.946897
 IRAQ                      |   1995 |  483404551.68855
 IRAQ                      |   1994 |  482500377.88178
 IRAQ                      |   1993 | 477243088.239356
 IRAQ                      |   1992 | 479217823.064046
 JAPAN                     |   1998 | 270878171.825653
 JAPAN                     |   1997 |   463248254.7805
 JAPAN                     |   1996 | 466632475.903615
 JAPAN                     |   1995 | 464053929.867117
 JAPAN                     |   1994 | 460519681.126701
 JAPAN                     |   1993 | 454004752.101869
 JAPAN                     |   1992 | 456016145.671511
 JORDAN                    |   1998 | 267086479.251529
 JORDAN                    |   1997 | 447128137.891823
 JORDAN                    |   1996 | 451571014.650185
 JORDAN                    |   1995 |  451916942.60825
 JORDAN                    |   1994 | 457542012.055055
 JORDAN                    |   1993 | 454851140.996648
 JORDAN                    |   1992 | 456136496.770554
 KENYA                     |   1998 | 271931266.961127
 KENYA                     |   1997 | 471310456.619282
 KENYA                     |   1996 | 469479697.390774
 KENYA                     |   1995 | 462522690.744699
 KENYA                     |   1994 | 469939644.105632
 KENYA                     |   1993 | 469652886.821122
 KENYA                     |   1992 | 466390128.886918
 MOROCCO                   |   1998 | 269607906.391477
 MOROCCO                   |   1997 | 466336210.057488
 MOROCCO                   |   1996 | 471527810.539123
 MOROCCO                   |   1995 |  467634212.05599
 MOROCCO                   |   1994 |  463386603.14904
 MOROCCO                   |   1993 |  459688514.27674
 MOROCCO                   |   1992 | 470464465.354893
 MOZAMBIQUE                |   1998 | 276243733.923019
 MOZAMBIQUE                |   1997 | 462708326.254747
 MOZAMBIQUE                |   1996 | 461402152.181145
 MOZAMBIQUE                |   1995 | 464178348.633769
 MOZAMBIQUE                |   1994 | 466305942.266174
 MOZAMBIQUE                |   1993 | 467905768.558828
 MOZAMBIQUE                |   1992 | 457683640.055707
 PERU                      |   1998 |  271793745.71331
 PERU                      |   1997 | 461987419.214443
 PERU                      |   1996 | 456362543.324634
 PERU                      |   1995 | 462946024.444912
 PERU                      |   1994 | 464624110.689456
 PERU                      |   1993 | 465931479.476449
 PERU                      |   1992 | 459021084.297259
 ROMANIA                   |   1998 |  271462712.62724
 ROMANIA                   |   1997 |  458716150.89201
 ROMANIA                   |   1996 | 454827396.308337
 ROMANIA                   |   1995 | 464816761.771057
 ROMANIA                   |   1994 | 466477644.077043
 ROMANIA                   |   1993 | 457795560.459487
 ROMANIA                   |   1992 | 467913870.092852
 RUSSIA                    |   1998 |   279097609.5257
 RUSSIA                    |   1997 | 475574526.063285
 RUSSIA                    |   1996 | 470179529.917019
 RUSSIA                    |   1995 | 469829015.111303
 RUSSIA                    |   1994 | 468901158.621899
 RUSSIA                    |   1993 | 472525980.780255
 RUSSIA                    |   1992 | 472829383.855053
 SAUDI ARABIA              |   1998 | 270709131.241145
 SAUDI ARABIA              |   1997 | 466485528.479573
 SAUDI ARABIA              |   1996 | 468648888.773105
 SAUDI ARABIA              |   1995 | 466918967.482508
 SAUDI ARABIA              |   1994 | 468318208.781448
 SAUDI ARABIA              |   1993 | 465101245.166683
 SAUDI ARABIA              |   1992 | 468223292.762291
 UNITED KINGDOM            |   1998 | 268871393.056645
 UNITED KINGDOM            |   1997 |  454563277.60572
 UNITED KINGDOM            |   1996 | 455872328.365358
 UNITED KINGDOM            |   1995 | 457773811.251124
 UNITED KINGDOM            |   1994 | 453202990.184602
 UNITED KINGDOM            |   1993 | 457545909.941353
 UNITED KINGDOM            |   1992 | 460793073.356958
 UNITED STATES             |   1998 | 281961057.227778
 UNITED STATES             |   1997 |  472986779.58939
 UNITED STATES             |   1996 | 482610064.208567
 UNITED STATES             |   1995 | 476188151.174171
 UNITED STATES             |   1994 | 472729297.671841
 UNITED STATES             |   1993 | 474809718.738149
 UNITED STATES             |   1992 | 487579009.283193
 VIETNAM                   |   1998 | 270684425.988287
 VIETNAM                   |   1997 | 463521236.502382
 VIETNAM                   |   1996 | 474988052.883484
 VIETNAM                   |   1995 | 466254451.857298
 VIETNAM                   |   1994 | 466605581.231007
 VIETNAM                   |   1993 | 473673983.998944
 VIETNAM                   |   1992 | 463903095.438851
(175 rows)

COMMIT;
COMMIT
