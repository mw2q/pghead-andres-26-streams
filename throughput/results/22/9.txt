BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%blush%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 270066261.102211
 ALGERIA                   |   1997 | 458786399.913639
 ALGERIA                   |   1996 |  465719038.24918
 ALGERIA                   |   1995 |  464946552.83185
 ALGERIA                   |   1994 |  459752044.46738
 ALGERIA                   |   1993 | 460602949.126308
 ALGERIA                   |   1992 | 462815247.658558
 ARGENTINA                 |   1998 | 272876756.262923
 ARGENTINA                 |   1997 | 468102598.604946
 ARGENTINA                 |   1996 | 467367006.601401
 ARGENTINA                 |   1995 | 471326653.748408
 ARGENTINA                 |   1994 | 462291939.591283
 ARGENTINA                 |   1993 | 467028593.172018
 ARGENTINA                 |   1992 | 464528959.948126
 BRAZIL                    |   1998 | 271530302.951759
 BRAZIL                    |   1997 | 459967962.760866
 BRAZIL                    |   1996 | 468950686.893073
 BRAZIL                    |   1995 | 470310164.215081
 BRAZIL                    |   1994 | 468124264.121702
 BRAZIL                    |   1993 | 462214698.352483
 BRAZIL                    |   1992 | 474892715.789773
 CANADA                    |   1998 | 280677045.246731
 CANADA                    |   1997 | 478000045.390276
 CANADA                    |   1996 |   472746887.4617
 CANADA                    |   1995 | 479132634.844805
 CANADA                    |   1994 | 486905039.795527
 CANADA                    |   1993 | 476528252.181372
 CANADA                    |   1992 | 472716979.932035
 CHINA                     |   1998 | 270856383.607763
 CHINA                     |   1997 | 453763207.220726
 CHINA                     |   1996 | 471702271.429107
 CHINA                     |   1995 | 468558639.410643
 CHINA                     |   1994 | 464729277.455412
 CHINA                     |   1993 | 466891579.221916
 CHINA                     |   1992 |  470931606.17853
 EGYPT                     |   1998 | 271789661.772424
 EGYPT                     |   1997 | 468968563.010872
 EGYPT                     |   1996 | 472224653.304048
 EGYPT                     |   1995 | 462756120.586343
 EGYPT                     |   1994 | 456074307.910196
 EGYPT                     |   1993 | 466015764.126908
 EGYPT                     |   1992 | 468235386.815098
 ETHIOPIA                  |   1998 | 264537124.592057
 ETHIOPIA                  |   1997 | 453623189.019688
 ETHIOPIA                  |   1996 | 450085983.230025
 ETHIOPIA                  |   1995 | 454075994.493151
 ETHIOPIA                  |   1994 | 455333096.172033
 ETHIOPIA                  |   1993 | 457945715.621906
 ETHIOPIA                  |   1992 | 458123907.247854
 FRANCE                    |   1998 | 274183766.098398
 FRANCE                    |   1997 | 463791516.989183
 FRANCE                    |   1996 | 464907001.051087
 FRANCE                    |   1995 |  458342903.50422
 FRANCE                    |   1994 | 459815394.225242
 FRANCE                    |   1993 | 460759066.248794
 FRANCE                    |   1992 | 460390597.812515
 GERMANY                   |   1998 | 279032981.162356
 GERMANY                   |   1997 | 477147473.978503
 GERMANY                   |   1996 | 475490144.407915
 GERMANY                   |   1995 | 463902724.435663
 GERMANY                   |   1994 | 481290027.259417
 GERMANY                   |   1993 | 473075928.447215
 GERMANY                   |   1992 |  478737757.87902
 INDIA                     |   1998 | 275672125.315503
 INDIA                     |   1997 | 464102361.622791
 INDIA                     |   1996 | 470026748.208361
 INDIA                     |   1995 | 474853282.710826
 INDIA                     |   1994 | 468506712.361093
 INDIA                     |   1993 | 467802979.849026
 INDIA                     |   1992 | 476229283.321756
 INDONESIA                 |   1998 | 275286012.740363
 INDONESIA                 |   1997 | 459693659.905149
 INDONESIA                 |   1996 | 464944162.476281
 INDONESIA                 |   1995 | 467825272.870096
 INDONESIA                 |   1994 | 463173247.971496
 INDONESIA                 |   1993 | 467644408.820545
 INDONESIA                 |   1992 | 457920670.965556
 IRAN                      |   1998 |  271647949.04199
 IRAN                      |   1997 |  464362864.57873
 IRAN                      |   1996 | 469763065.266627
 IRAN                      |   1995 | 470250673.567603
 IRAN                      |   1994 | 464763522.195185
 IRAN                      |   1993 |  463021024.21286
 IRAN                      |   1992 | 463965026.583028
 IRAQ                      |   1998 |  275181294.75566
 IRAQ                      |   1997 | 470886965.109215
 IRAQ                      |   1996 | 476310233.875546
 IRAQ                      |   1995 | 470755337.246938
 IRAQ                      |   1994 | 473845724.815334
 IRAQ                      |   1993 | 475593816.244511
 IRAQ                      |   1992 | 474516055.946932
 JAPAN                     |   1998 | 273126763.261399
 JAPAN                     |   1997 | 463286288.792114
 JAPAN                     |   1996 | 462626107.999088
 JAPAN                     |   1995 | 457237432.290778
 JAPAN                     |   1994 | 450823142.914373
 JAPAN                     |   1993 |  462157526.88818
 JAPAN                     |   1992 | 462041818.461184
 JORDAN                    |   1998 | 272894406.413547
 JORDAN                    |   1997 |  468067444.58379
 JORDAN                    |   1996 | 459172996.691968
 JORDAN                    |   1995 | 453410077.506659
 JORDAN                    |   1994 | 461415237.425587
 JORDAN                    |   1993 | 464631345.993636
 JORDAN                    |   1992 | 462379474.161063
 KENYA                     |   1998 | 270280124.689033
 KENYA                     |   1997 | 466329381.777507
 KENYA                     |   1996 | 472065149.156532
 KENYA                     |   1995 | 470135110.340458
 KENYA                     |   1994 | 472488071.342214
 KENYA                     |   1993 | 467862473.283959
 KENYA                     |   1992 | 474412811.500364
 MOROCCO                   |   1998 | 265593750.434886
 MOROCCO                   |   1997 | 468367089.860535
 MOROCCO                   |   1996 | 466327461.287542
 MOROCCO                   |   1995 | 461514816.349351
 MOROCCO                   |   1994 |  459650341.31253
 MOROCCO                   |   1993 | 466197260.899282
 MOROCCO                   |   1992 | 464144578.098859
 MOZAMBIQUE                |   1998 |  270562007.99664
 MOZAMBIQUE                |   1997 | 453360051.871071
 MOZAMBIQUE                |   1996 | 454088013.554084
 MOZAMBIQUE                |   1995 |  457721191.19046
 MOZAMBIQUE                |   1994 | 461460705.559792
 MOZAMBIQUE                |   1993 | 459210495.951731
 MOZAMBIQUE                |   1992 | 460949059.696081
 PERU                      |   1998 | 268621454.067978
 PERU                      |   1997 | 469261071.517107
 PERU                      |   1996 | 470538776.649126
 PERU                      |   1995 | 467206318.143678
 PERU                      |   1994 | 459371526.125715
 PERU                      |   1993 | 469843490.270689
 PERU                      |   1992 | 460939092.346897
 ROMANIA                   |   1998 | 275433990.921138
 ROMANIA                   |   1997 | 464003745.084987
 ROMANIA                   |   1996 | 471144582.458731
 ROMANIA                   |   1995 |   467325295.4314
 ROMANIA                   |   1994 | 464889924.689116
 ROMANIA                   |   1993 | 472588312.581962
 ROMANIA                   |   1992 | 470652804.517578
 RUSSIA                    |   1998 | 269876704.032799
 RUSSIA                    |   1997 | 464676002.859037
 RUSSIA                    |   1996 | 474855921.841593
 RUSSIA                    |   1995 | 467372527.240211
 RUSSIA                    |   1994 | 462607440.224313
 RUSSIA                    |   1993 | 468356848.286213
 RUSSIA                    |   1992 |  464310027.52131
 SAUDI ARABIA              |   1998 |  278508628.72883
 SAUDI ARABIA              |   1997 | 474643252.851925
 SAUDI ARABIA              |   1996 | 462386619.701523
 SAUDI ARABIA              |   1995 | 467999054.674189
 SAUDI ARABIA              |   1994 |  470894876.74927
 SAUDI ARABIA              |   1993 | 461346970.051211
 SAUDI ARABIA              |   1992 | 467103172.751504
 UNITED KINGDOM            |   1998 | 263553348.806162
 UNITED KINGDOM            |   1997 | 450082778.220249
 UNITED KINGDOM            |   1996 | 452500016.797551
 UNITED KINGDOM            |   1995 | 457962487.691728
 UNITED KINGDOM            |   1994 | 465349081.457299
 UNITED KINGDOM            |   1993 | 452446782.106148
 UNITED KINGDOM            |   1992 | 453270743.891672
 UNITED STATES             |   1998 | 267099238.458166
 UNITED STATES             |   1997 | 466045297.856384
 UNITED STATES             |   1996 | 462518156.294457
 UNITED STATES             |   1995 | 461971596.539925
 UNITED STATES             |   1994 | 462898828.321819
 UNITED STATES             |   1993 | 460439458.992178
 UNITED STATES             |   1992 | 459617158.092277
 VIETNAM                   |   1998 | 272863588.944917
 VIETNAM                   |   1997 | 462634531.300392
 VIETNAM                   |   1996 | 465853571.343418
 VIETNAM                   |   1995 | 467491764.059342
 VIETNAM                   |   1994 | 475166513.686978
 VIETNAM                   |   1993 | 466401395.653592
 VIETNAM                   |   1992 | 460843952.944641
(175 rows)

COMMIT;
COMMIT
