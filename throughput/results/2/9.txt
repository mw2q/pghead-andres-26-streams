BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%indian%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264110423.859656
 ALGERIA                   |   1997 | 464776088.437767
 ALGERIA                   |   1996 | 455745148.293964
 ALGERIA                   |   1995 | 467471388.096156
 ALGERIA                   |   1994 | 454577582.845036
 ALGERIA                   |   1993 | 462462703.796109
 ALGERIA                   |   1992 | 462597088.602687
 ARGENTINA                 |   1998 | 270374812.784644
 ARGENTINA                 |   1997 |  469082958.08735
 ARGENTINA                 |   1996 | 468094634.313111
 ARGENTINA                 |   1995 | 463306781.834492
 ARGENTINA                 |   1994 | 464427122.831519
 ARGENTINA                 |   1993 | 457947836.615503
 ARGENTINA                 |   1992 | 456498482.845548
 BRAZIL                    |   1998 | 278903204.282371
 BRAZIL                    |   1997 | 464666512.857125
 BRAZIL                    |   1996 | 469640844.246168
 BRAZIL                    |   1995 | 461962068.696069
 BRAZIL                    |   1994 | 465700323.623648
 BRAZIL                    |   1993 | 464758696.365803
 BRAZIL                    |   1992 | 475546755.324285
 CANADA                    |   1998 | 275267572.731112
 CANADA                    |   1997 | 482737045.906711
 CANADA                    |   1996 | 484448384.552654
 CANADA                    |   1995 | 484841503.944786
 CANADA                    |   1994 | 485095018.043825
 CANADA                    |   1993 | 487537621.067003
 CANADA                    |   1992 | 474014644.476609
 CHINA                     |   1998 | 272308435.209039
 CHINA                     |   1997 | 463459856.755549
 CHINA                     |   1996 | 464931716.446701
 CHINA                     |   1995 | 463479720.773024
 CHINA                     |   1994 | 462260576.210549
 CHINA                     |   1993 | 466604615.259943
 CHINA                     |   1992 | 462402964.023723
 EGYPT                     |   1998 | 269613294.461917
 EGYPT                     |   1997 | 461990211.413776
 EGYPT                     |   1996 | 466223058.196468
 EGYPT                     |   1995 | 465511432.093823
 EGYPT                     |   1994 | 455019987.807368
 EGYPT                     |   1993 | 475443398.696285
 EGYPT                     |   1992 | 466539472.361158
 ETHIOPIA                  |   1998 | 272388941.499634
 ETHIOPIA                  |   1997 | 462663352.926246
 ETHIOPIA                  |   1996 | 451066745.664697
 ETHIOPIA                  |   1995 | 464611694.044065
 ETHIOPIA                  |   1994 | 462001014.266331
 ETHIOPIA                  |   1993 | 457521295.055453
 ETHIOPIA                  |   1992 | 463758234.078233
 FRANCE                    |   1998 | 267913389.456871
 FRANCE                    |   1997 | 463284560.798581
 FRANCE                    |   1996 | 470716586.543586
 FRANCE                    |   1995 | 466661833.283844
 FRANCE                    |   1994 | 466291273.500137
 FRANCE                    |   1993 | 468261878.888495
 FRANCE                    |   1992 | 462937946.154335
 GERMANY                   |   1998 |  281429479.98456
 GERMANY                   |   1997 | 469735076.885178
 GERMANY                   |   1996 | 478369485.897978
 GERMANY                   |   1995 | 468464473.559486
 GERMANY                   |   1994 | 474431971.854711
 GERMANY                   |   1993 | 476407607.706105
 GERMANY                   |   1992 | 480495303.213236
 INDIA                     |   1998 | 276083710.874319
 INDIA                     |   1997 |  471808868.18909
 INDIA                     |   1996 | 471541238.721012
 INDIA                     |   1995 |  476195260.93167
 INDIA                     |   1994 | 475099375.326934
 INDIA                     |   1993 | 469210211.863559
 INDIA                     |   1992 | 468062668.244562
 INDONESIA                 |   1998 | 273193347.346518
 INDONESIA                 |   1997 | 454156648.078704
 INDONESIA                 |   1996 | 466736773.409776
 INDONESIA                 |   1995 | 466559278.971758
 INDONESIA                 |   1994 | 460360103.831463
 INDONESIA                 |   1993 | 471813411.030624
 INDONESIA                 |   1992 | 466217353.455051
 IRAN                      |   1998 | 271443587.878196
 IRAN                      |   1997 | 456801082.724106
 IRAN                      |   1996 | 458340263.596072
 IRAN                      |   1995 | 463546975.013774
 IRAN                      |   1994 | 462193742.441742
 IRAN                      |   1993 | 453346660.691573
 IRAN                      |   1992 |  453520949.07236
 IRAQ                      |   1998 |  277978637.96659
 IRAQ                      |   1997 | 473877417.417592
 IRAQ                      |   1996 | 467009804.823705
 IRAQ                      |   1995 | 468397687.797935
 IRAQ                      |   1994 |  474977566.55065
 IRAQ                      |   1993 | 466029138.948377
 IRAQ                      |   1992 | 468488895.779546
 JAPAN                     |   1998 | 267501684.222869
 JAPAN                     |   1997 | 463068830.651617
 JAPAN                     |   1996 | 459347215.501786
 JAPAN                     |   1995 | 467524807.040666
 JAPAN                     |   1994 | 462181670.340635
 JAPAN                     |   1993 | 466019683.954093
 JAPAN                     |   1992 | 465287332.632931
 JORDAN                    |   1998 | 264051417.455052
 JORDAN                    |   1997 | 456836777.213168
 JORDAN                    |   1996 | 457714730.079278
 JORDAN                    |   1995 | 456487595.921065
 JORDAN                    |   1994 | 455453155.942709
 JORDAN                    |   1993 |  453361972.28014
 JORDAN                    |   1992 | 459398484.991776
 KENYA                     |   1998 | 277151441.612233
 KENYA                     |   1997 | 472659420.266532
 KENYA                     |   1996 | 471721962.895094
 KENYA                     |   1995 | 468694675.084687
 KENYA                     |   1994 | 466308042.526707
 KENYA                     |   1993 |  462632762.94201
 KENYA                     |   1992 | 465221136.753067
 MOROCCO                   |   1998 | 275676375.757527
 MOROCCO                   |   1997 | 466737793.684186
 MOROCCO                   |   1996 | 468659540.478604
 MOROCCO                   |   1995 | 466769747.236871
 MOROCCO                   |   1994 | 468958131.693004
 MOROCCO                   |   1993 | 479832966.768574
 MOROCCO                   |   1992 |  462604862.13397
 MOZAMBIQUE                |   1998 |  273485398.80092
 MOZAMBIQUE                |   1997 | 460864840.416045
 MOZAMBIQUE                |   1996 | 463260105.783905
 MOZAMBIQUE                |   1995 | 463686641.037387
 MOZAMBIQUE                |   1994 | 459753528.696086
 MOZAMBIQUE                |   1993 | 459354207.178059
 MOZAMBIQUE                |   1992 | 461834100.691995
 PERU                      |   1998 | 276319120.538247
 PERU                      |   1997 | 475778332.350581
 PERU                      |   1996 | 465569705.464031
 PERU                      |   1995 | 467845399.236092
 PERU                      |   1994 | 460719631.352833
 PERU                      |   1993 | 471968598.415357
 PERU                      |   1992 | 473279701.267245
 ROMANIA                   |   1998 | 275913229.168964
 ROMANIA                   |   1997 | 465149595.512916
 ROMANIA                   |   1996 | 456927597.975933
 ROMANIA                   |   1995 | 468185201.207663
 ROMANIA                   |   1994 | 467398446.868319
 ROMANIA                   |   1993 | 464877226.677651
 ROMANIA                   |   1992 | 461696749.984106
 RUSSIA                    |   1998 | 283943647.345635
 RUSSIA                    |   1997 |  472710468.40268
 RUSSIA                    |   1996 | 483814854.472302
 RUSSIA                    |   1995 |    467178240.921
 RUSSIA                    |   1994 | 476166681.570403
 RUSSIA                    |   1993 |  468980788.76722
 RUSSIA                    |   1992 | 468969145.728085
 SAUDI ARABIA              |   1998 |  272855989.43568
 SAUDI ARABIA              |   1997 | 465727016.020482
 SAUDI ARABIA              |   1996 | 470088217.976797
 SAUDI ARABIA              |   1995 | 467326622.934462
 SAUDI ARABIA              |   1994 | 469409003.712764
 SAUDI ARABIA              |   1993 | 468789071.631577
 SAUDI ARABIA              |   1992 | 469000506.010132
 UNITED KINGDOM            |   1998 | 276689214.864161
 UNITED KINGDOM            |   1997 | 467874608.241631
 UNITED KINGDOM            |   1996 | 475139952.361984
 UNITED KINGDOM            |   1995 | 471280699.150028
 UNITED KINGDOM            |   1994 | 465117531.906828
 UNITED KINGDOM            |   1993 | 476438556.449896
 UNITED KINGDOM            |   1992 | 458371746.496659
 UNITED STATES             |   1998 | 274390087.896389
 UNITED STATES             |   1997 | 467206393.332062
 UNITED STATES             |   1996 | 469721323.969965
 UNITED STATES             |   1995 | 463951039.512256
 UNITED STATES             |   1994 | 468884194.073896
 UNITED STATES             |   1993 | 464073990.964378
 UNITED STATES             |   1992 | 467170963.076024
 VIETNAM                   |   1998 | 265986902.899793
 VIETNAM                   |   1997 | 457978416.770381
 VIETNAM                   |   1996 | 462534378.705372
 VIETNAM                   |   1995 |  458228548.03048
 VIETNAM                   |   1994 | 464588294.656869
 VIETNAM                   |   1993 | 460678283.842751
 VIETNAM                   |   1992 | 456740807.290293
(175 rows)

COMMIT;
COMMIT
