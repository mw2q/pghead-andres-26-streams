BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%olive%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 260388847.871929
 ALGERIA                   |   1997 |  448004023.27123
 ALGERIA                   |   1996 |   451846072.9659
 ALGERIA                   |   1995 |  448510675.47158
 ALGERIA                   |   1994 | 448789261.599765
 ALGERIA                   |   1993 | 454902973.629246
 ALGERIA                   |   1992 | 458286935.516406
 ARGENTINA                 |   1998 | 275240185.183225
 ARGENTINA                 |   1997 | 477658432.120547
 ARGENTINA                 |   1996 | 472335717.746727
 ARGENTINA                 |   1995 | 470559988.641812
 ARGENTINA                 |   1994 | 470121054.933848
 ARGENTINA                 |   1993 |  464165328.81819
 ARGENTINA                 |   1992 | 477443760.731161
 BRAZIL                    |   1998 |  273809144.79785
 BRAZIL                    |   1997 | 464941884.579889
 BRAZIL                    |   1996 | 468947003.630479
 BRAZIL                    |   1995 | 469527023.805186
 BRAZIL                    |   1994 | 466999499.347304
 BRAZIL                    |   1993 | 466595147.965932
 BRAZIL                    |   1992 | 468058790.586606
 CANADA                    |   1998 | 278555641.296103
 CANADA                    |   1997 | 474208531.957894
 CANADA                    |   1996 | 465386623.833875
 CANADA                    |   1995 | 473973866.265324
 CANADA                    |   1994 | 478405332.478448
 CANADA                    |   1993 | 470839825.456539
 CANADA                    |   1992 | 483239127.199583
 CHINA                     |   1998 |  273204453.35053
 CHINA                     |   1997 | 466345424.638144
 CHINA                     |   1996 | 466662792.119683
 CHINA                     |   1995 | 466571677.320969
 CHINA                     |   1994 | 474766031.831876
 CHINA                     |   1993 | 466220086.348246
 CHINA                     |   1992 | 463210781.639631
 EGYPT                     |   1998 | 272168683.430388
 EGYPT                     |   1997 | 458950318.485138
 EGYPT                     |   1996 | 468117148.729215
 EGYPT                     |   1995 | 459723926.268014
 EGYPT                     |   1994 | 462527045.172918
 EGYPT                     |   1993 | 460329045.668276
 EGYPT                     |   1992 | 462150444.784633
 ETHIOPIA                  |   1998 | 267852950.994767
 ETHIOPIA                  |   1997 | 455178872.823787
 ETHIOPIA                  |   1996 | 458638092.121496
 ETHIOPIA                  |   1995 | 463726032.305396
 ETHIOPIA                  |   1994 | 453140092.447536
 ETHIOPIA                  |   1993 | 458437246.854246
 ETHIOPIA                  |   1992 | 459098513.229177
 FRANCE                    |   1998 | 268726164.593672
 FRANCE                    |   1997 |  455334667.08936
 FRANCE                    |   1996 | 459037550.245962
 FRANCE                    |   1995 |  458444066.21403
 FRANCE                    |   1994 | 463836312.653396
 FRANCE                    |   1993 | 455801026.957526
 FRANCE                    |   1992 |  455594748.45608
 GERMANY                   |   1998 | 283473677.428902
 GERMANY                   |   1997 | 477607809.356808
 GERMANY                   |   1996 | 476331290.222951
 GERMANY                   |   1995 | 477308705.855768
 GERMANY                   |   1994 | 471489136.208443
 GERMANY                   |   1993 | 480311125.411418
 GERMANY                   |   1992 | 473564989.819701
 INDIA                     |   1998 | 269057460.692599
 INDIA                     |   1997 | 468922176.034188
 INDIA                     |   1996 | 467781429.442399
 INDIA                     |   1995 | 466586218.422835
 INDIA                     |   1994 | 467967615.577588
 INDIA                     |   1993 | 473328582.074935
 INDIA                     |   1992 | 468447910.449978
 INDONESIA                 |   1998 | 271481522.291771
 INDONESIA                 |   1997 | 459929404.763878
 INDONESIA                 |   1996 | 461214187.363699
 INDONESIA                 |   1995 | 457530567.306929
 INDONESIA                 |   1994 | 467183283.892205
 INDONESIA                 |   1993 | 468748163.046952
 INDONESIA                 |   1992 | 467366600.470422
 IRAN                      |   1998 | 263006248.256193
 IRAN                      |   1997 |  450982790.89651
 IRAN                      |   1996 | 450622264.974606
 IRAN                      |   1995 | 453495151.961558
 IRAN                      |   1994 | 453868533.710388
 IRAN                      |   1993 | 457768599.487169
 IRAN                      |   1992 | 455592642.915545
 IRAQ                      |   1998 | 271660073.226765
 IRAQ                      |   1997 | 468058971.370993
 IRAQ                      |   1996 | 469721298.888336
 IRAQ                      |   1995 | 459738128.660737
 IRAQ                      |   1994 | 476829506.173052
 IRAQ                      |   1993 | 466761756.163177
 IRAQ                      |   1992 | 475465786.500893
 JAPAN                     |   1998 | 271164636.793062
 JAPAN                     |   1997 | 462643794.637465
 JAPAN                     |   1996 | 455468523.033658
 JAPAN                     |   1995 | 465856779.215152
 JAPAN                     |   1994 | 459447258.002554
 JAPAN                     |   1993 | 460223710.043868
 JAPAN                     |   1992 | 461605854.512114
 JORDAN                    |   1998 | 268018865.033648
 JORDAN                    |   1997 | 449134733.093432
 JORDAN                    |   1996 | 452481391.613688
 JORDAN                    |   1995 | 450551228.223132
 JORDAN                    |   1994 | 456231709.872853
 JORDAN                    |   1993 |  450338709.77001
 JORDAN                    |   1992 | 456386470.242715
 KENYA                     |   1998 | 263720411.735961
 KENYA                     |   1997 |  467081744.04845
 KENYA                     |   1996 |  456637280.35371
 KENYA                     |   1995 | 464333829.882382
 KENYA                     |   1994 | 471935231.172438
 KENYA                     |   1993 | 463210905.037109
 KENYA                     |   1992 | 462685960.745511
 MOROCCO                   |   1998 | 274289065.617499
 MOROCCO                   |   1997 |  459109870.05131
 MOROCCO                   |   1996 | 454271022.212652
 MOROCCO                   |   1995 | 470364376.278565
 MOROCCO                   |   1994 | 463275169.830029
 MOROCCO                   |   1993 | 467208546.269439
 MOROCCO                   |   1992 |  464401689.10218
 MOZAMBIQUE                |   1998 | 269753628.596193
 MOZAMBIQUE                |   1997 | 454767738.409285
 MOZAMBIQUE                |   1996 | 465424201.273482
 MOZAMBIQUE                |   1995 | 463944708.908044
 MOZAMBIQUE                |   1994 | 465253771.775495
 MOZAMBIQUE                |   1993 | 442108404.808986
 MOZAMBIQUE                |   1992 | 459415820.815269
 PERU                      |   1998 | 276643852.487056
 PERU                      |   1997 | 462367162.250753
 PERU                      |   1996 | 464610875.210911
 PERU                      |   1995 | 464530457.789158
 PERU                      |   1994 | 472347319.439273
 PERU                      |   1993 | 469311918.775489
 PERU                      |   1992 | 470409432.151448
 ROMANIA                   |   1998 |  272474363.30676
 ROMANIA                   |   1997 | 461948279.629388
 ROMANIA                   |   1996 | 464718484.828275
 ROMANIA                   |   1995 | 463454130.400872
 ROMANIA                   |   1994 | 462465712.672509
 ROMANIA                   |   1993 | 451722270.364617
 ROMANIA                   |   1992 | 465936847.919169
 RUSSIA                    |   1998 | 271852215.324671
 RUSSIA                    |   1997 | 467391936.527819
 RUSSIA                    |   1996 | 471434473.582367
 RUSSIA                    |   1995 | 467120795.041954
 RUSSIA                    |   1994 | 470394676.075573
 RUSSIA                    |   1993 | 465851833.718039
 RUSSIA                    |   1992 | 478267742.553088
 SAUDI ARABIA              |   1998 | 277235073.404565
 SAUDI ARABIA              |   1997 | 470047462.299105
 SAUDI ARABIA              |   1996 | 478104949.178691
 SAUDI ARABIA              |   1995 |  468513230.51828
 SAUDI ARABIA              |   1994 |  480460245.24133
 SAUDI ARABIA              |   1993 | 468256096.921669
 SAUDI ARABIA              |   1992 | 473555162.930391
 UNITED KINGDOM            |   1998 | 269443083.968925
 UNITED KINGDOM            |   1997 | 463424284.899684
 UNITED KINGDOM            |   1996 | 455228915.460522
 UNITED KINGDOM            |   1995 | 463544400.600178
 UNITED KINGDOM            |   1994 | 459807438.643112
 UNITED KINGDOM            |   1993 | 461417103.272407
 UNITED KINGDOM            |   1992 | 458657524.373852
 UNITED STATES             |   1998 |  275173169.19546
 UNITED STATES             |   1997 |  480041251.66422
 UNITED STATES             |   1996 | 463337578.963426
 UNITED STATES             |   1995 | 473438934.319987
 UNITED STATES             |   1994 | 474416583.841668
 UNITED STATES             |   1993 | 469604463.569443
 UNITED STATES             |   1992 | 471782896.908645
 VIETNAM                   |   1998 | 267807211.594712
 VIETNAM                   |   1997 | 460185323.174136
 VIETNAM                   |   1996 | 459878087.211857
 VIETNAM                   |   1995 | 459315658.382143
 VIETNAM                   |   1994 | 463730484.344285
 VIETNAM                   |   1993 | 469218815.269497
 VIETNAM                   |   1992 | 466800191.409486
(175 rows)

COMMIT;
COMMIT
