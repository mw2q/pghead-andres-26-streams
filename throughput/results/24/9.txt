BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%wheat%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 267188311.097344
 ALGERIA                   |   1997 |  455535841.86748
 ALGERIA                   |   1996 | 452457031.829203
 ALGERIA                   |   1995 | 459603614.250732
 ALGERIA                   |   1994 | 450936071.746608
 ALGERIA                   |   1993 | 456793516.731674
 ALGERIA                   |   1992 | 456781666.375832
 ARGENTINA                 |   1998 | 271893245.875937
 ARGENTINA                 |   1997 | 473840461.774149
 ARGENTINA                 |   1996 | 469683133.598366
 ARGENTINA                 |   1995 |  466855306.55173
 ARGENTINA                 |   1994 | 474917952.016284
 ARGENTINA                 |   1993 | 467914102.963701
 ARGENTINA                 |   1992 | 474183772.211517
 BRAZIL                    |   1998 |  274701807.09999
 BRAZIL                    |   1997 | 467236069.206228
 BRAZIL                    |   1996 | 466560687.693223
 BRAZIL                    |   1995 | 465473273.037457
 BRAZIL                    |   1994 | 469069273.434944
 BRAZIL                    |   1993 | 464521267.599767
 BRAZIL                    |   1992 | 476893420.220062
 CANADA                    |   1998 | 280691418.245337
 CANADA                    |   1997 | 481271860.129481
 CANADA                    |   1996 | 477591288.601222
 CANADA                    |   1995 | 475088926.173644
 CANADA                    |   1994 | 484922825.975157
 CANADA                    |   1993 | 480225829.621948
 CANADA                    |   1992 | 476228613.950517
 CHINA                     |   1998 | 273747533.295949
 CHINA                     |   1997 |  467873803.51132
 CHINA                     |   1996 | 471760785.904751
 CHINA                     |   1995 | 455902531.734767
 CHINA                     |   1994 | 468345787.499467
 CHINA                     |   1993 | 474373653.651864
 CHINA                     |   1992 | 469131730.939157
 EGYPT                     |   1998 | 276663557.392396
 EGYPT                     |   1997 |   462115178.7326
 EGYPT                     |   1996 | 466234418.112412
 EGYPT                     |   1995 | 462642903.300537
 EGYPT                     |   1994 | 463933836.934766
 EGYPT                     |   1993 |  458626080.42128
 EGYPT                     |   1992 | 462380195.359859
 ETHIOPIA                  |   1998 | 263799491.079374
 ETHIOPIA                  |   1997 | 450040586.021574
 ETHIOPIA                  |   1996 | 452280383.810692
 ETHIOPIA                  |   1995 | 453554078.454563
 ETHIOPIA                  |   1994 | 459419400.398388
 ETHIOPIA                  |   1993 | 453477658.282026
 ETHIOPIA                  |   1992 | 452515291.849801
 FRANCE                    |   1998 | 268574237.601769
 FRANCE                    |   1997 |  453709482.27284
 FRANCE                    |   1996 | 459388868.151226
 FRANCE                    |   1995 | 465677859.288273
 FRANCE                    |   1994 | 453438209.605817
 FRANCE                    |   1993 | 460001647.508583
 FRANCE                    |   1992 |  458766699.62247
 GERMANY                   |   1998 | 277893438.931581
 GERMANY                   |   1997 | 473130299.616827
 GERMANY                   |   1996 | 472475765.421923
 GERMANY                   |   1995 | 468722129.088821
 GERMANY                   |   1994 | 471275048.858509
 GERMANY                   |   1993 | 472648138.514044
 GERMANY                   |   1992 |  466909322.81375
 INDIA                     |   1998 | 270416442.800852
 INDIA                     |   1997 | 468340670.466912
 INDIA                     |   1996 | 466843493.894384
 INDIA                     |   1995 | 464236954.380321
 INDIA                     |   1994 | 469510626.364009
 INDIA                     |   1993 | 464182873.331385
 INDIA                     |   1992 | 470248776.658353
 INDONESIA                 |   1998 | 267595482.972264
 INDONESIA                 |   1997 | 462438597.863634
 INDONESIA                 |   1996 | 458361483.274747
 INDONESIA                 |   1995 | 457200190.903537
 INDONESIA                 |   1994 | 462718050.206251
 INDONESIA                 |   1993 | 458274151.927103
 INDONESIA                 |   1992 |  458824515.27964
 IRAN                      |   1998 | 267840906.104391
 IRAN                      |   1997 | 446620876.798601
 IRAN                      |   1996 | 459938936.375096
 IRAN                      |   1995 | 454232449.203448
 IRAN                      |   1994 | 459249911.260706
 IRAN                      |   1993 | 453523865.434007
 IRAN                      |   1992 |  454582781.89172
 IRAQ                      |   1998 | 276977642.901925
 IRAQ                      |   1997 | 470090078.592475
 IRAQ                      |   1996 | 472791255.408936
 IRAQ                      |   1995 |   471379701.2888
 IRAQ                      |   1994 | 468384847.165514
 IRAQ                      |   1993 | 469042652.230674
 IRAQ                      |   1992 | 464752876.644744
 JAPAN                     |   1998 | 271555879.376162
 JAPAN                     |   1997 | 466409501.556998
 JAPAN                     |   1996 | 460375378.428335
 JAPAN                     |   1995 | 463374891.769917
 JAPAN                     |   1994 | 469160138.899538
 JAPAN                     |   1993 | 472977114.844382
 JAPAN                     |   1992 | 465098048.533841
 JORDAN                    |   1998 | 270828110.412992
 JORDAN                    |   1997 |  464706532.23458
 JORDAN                    |   1996 | 455663232.321839
 JORDAN                    |   1995 |  458485764.45283
 JORDAN                    |   1994 | 459326491.395029
 JORDAN                    |   1993 | 461767695.218083
 JORDAN                    |   1992 | 463219596.709171
 KENYA                     |   1998 | 272172127.653843
 KENYA                     |   1997 |    459996930.103
 KENYA                     |   1996 | 467339233.420607
 KENYA                     |   1995 | 458736363.664019
 KENYA                     |   1994 | 459529909.156748
 KENYA                     |   1993 | 465309592.483492
 KENYA                     |   1992 | 463811665.914581
 MOROCCO                   |   1998 | 272333632.029608
 MOROCCO                   |   1997 | 466436727.935655
 MOROCCO                   |   1996 | 471671192.276348
 MOROCCO                   |   1995 | 469457494.626177
 MOROCCO                   |   1994 | 463144892.422065
 MOROCCO                   |   1993 | 468634156.388306
 MOROCCO                   |   1992 | 470773779.316239
 MOZAMBIQUE                |   1998 | 273155879.676099
 MOZAMBIQUE                |   1997 | 455134494.295498
 MOZAMBIQUE                |   1996 | 464152143.285421
 MOZAMBIQUE                |   1995 | 459571329.231847
 MOZAMBIQUE                |   1994 | 457933714.720107
 MOZAMBIQUE                |   1993 | 453041914.297068
 MOZAMBIQUE                |   1992 | 461088421.817671
 PERU                      |   1998 | 268263058.304011
 PERU                      |   1997 |  474006408.32071
 PERU                      |   1996 | 469538464.220432
 PERU                      |   1995 |  457347375.88185
 PERU                      |   1994 | 466433826.185327
 PERU                      |   1993 |  466230900.42669
 PERU                      |   1992 | 475460989.843827
 ROMANIA                   |   1998 | 271562916.883099
 ROMANIA                   |   1997 |  458809821.92596
 ROMANIA                   |   1996 |  465849363.27355
 ROMANIA                   |   1995 | 461393068.826117
 ROMANIA                   |   1994 | 457003812.730623
 ROMANIA                   |   1993 | 457065243.632123
 ROMANIA                   |   1992 | 460331381.580553
 RUSSIA                    |   1998 | 280345467.201919
 RUSSIA                    |   1997 | 467176105.013181
 RUSSIA                    |   1996 | 480134260.899704
 RUSSIA                    |   1995 | 470881368.808419
 RUSSIA                    |   1994 | 471511893.534491
 RUSSIA                    |   1993 |  466163340.47143
 RUSSIA                    |   1992 |  464534242.38172
 SAUDI ARABIA              |   1998 | 278821204.600617
 SAUDI ARABIA              |   1997 | 464987635.280179
 SAUDI ARABIA              |   1996 | 476241577.558365
 SAUDI ARABIA              |   1995 | 465032573.910282
 SAUDI ARABIA              |   1994 | 465315977.248661
 SAUDI ARABIA              |   1993 | 468164782.333049
 SAUDI ARABIA              |   1992 | 471921199.490112
 UNITED KINGDOM            |   1998 | 271021868.428753
 UNITED KINGDOM            |   1997 | 455473651.522053
 UNITED KINGDOM            |   1996 | 453559340.341163
 UNITED KINGDOM            |   1995 | 453718000.965204
 UNITED KINGDOM            |   1994 | 460748454.625017
 UNITED KINGDOM            |   1993 | 457235140.832157
 UNITED KINGDOM            |   1992 |   451015036.6809
 UNITED STATES             |   1998 | 274909470.251052
 UNITED STATES             |   1997 | 468757084.042498
 UNITED STATES             |   1996 |  462370858.61131
 UNITED STATES             |   1995 | 464875438.678142
 UNITED STATES             |   1994 |  472161477.75861
 UNITED STATES             |   1993 | 463253393.830665
 UNITED STATES             |   1992 | 466705106.477979
 VIETNAM                   |   1998 | 271234064.329284
 VIETNAM                   |   1997 | 457411558.482691
 VIETNAM                   |   1996 | 465228666.106882
 VIETNAM                   |   1995 | 462347618.634137
 VIETNAM                   |   1994 | 468014830.989521
 VIETNAM                   |   1993 | 467002712.842174
 VIETNAM                   |   1992 | 463401244.868979
(175 rows)

COMMIT;
COMMIT
